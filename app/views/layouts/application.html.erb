<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Kurss" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Kurss">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body style="margin: 0; font-family: sans-serif;">
  
    <header style="background-color: #333; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;">
      
      <div style="display: flex; gap: 20px; align-items: center;">
        <%= link_to "ðŸ  Ð“Ð¾Ð»Ð¾Ð²Ð½Ð°", root_path, style: "color: white; text-decoration: none; font-weight: 500;" %>
        <%= link_to "ðŸ›’ Ð¢Ð¾Ð²Ð°Ñ€Ð¸ (ÐšÐ°Ñ‚Ð°Ð»Ð¾Ð³)", products_path, style: "color: white; text-decoration: none; font-weight: 500;" %>
        
        <% if user_signed_in? %>
           <%= link_to "ðŸ‘¤ ÐœÑ–Ð¹ ÐšÐ°Ð±Ñ–Ð½ÐµÑ‚", dashboard_path, style: "color: #ffc107; text-decoration: none; font-weight: bold;" %>
        <% end %>
      </div>

      <div style="display: flex; gap: 25px; align-items: center;">
        
        <%= link_to cart_path, style: "color: white; text-decoration: none; font-weight: bold; display: flex; align-items: center; gap: 8px;" do %>
          ðŸ›’ ÐšÐ¾ÑˆÐ¸Ðº 
          <% if @cart && @cart.cart_items.sum(:quantity) > 0 %>
            <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px;">
              <%= @cart.cart_items.sum(:quantity) %>
            </span>
          <% end %>
        <% end %>

        <% if user_signed_in? %>
          <div style="display: flex; align-items: center; gap: 10px;">
            <% if current_user.admin? %>
              <span style="color: #ff6b6b; font-weight: bold; font-size: 12px; border: 1px solid #ff6b6b; padding: 2px 5px; border-radius: 4px;">ADMIN</span>
            <% end %>
            
            <span>
              Ð’Ñ–Ñ‚Ð°ÑŽ, <strong><%= current_user.first_name.presence || current_user.email %></strong>!
            </span>
          </div>
        <% else %>
          <div>
            <%= link_to "Ð£Ð²Ñ–Ð¹Ñ‚Ð¸", new_user_session_path, style: "color: #81ecec; text-decoration: none; margin-right: 15px;" %>
            <%= link_to "Ð ÐµÑ”ÑÑ‚Ñ€Ð°Ñ†Ñ–Ñ", new_user_registration_path, style: "background: white; color: #333; padding: 5px 15px; border-radius: 4px; text-decoration: none; font-weight: bold;" %>
          </div>
        <% end %>
      </div>
    </header>

    <% if notice %>
      <div style="background-color: #d4edda; color: #155724; padding: 15px; text-align: center; border-bottom: 1px solid #c3e6cb;">
        <%= notice %>
      </div>
    <% end %>

    <% if alert %>
      <div style="background-color: #f8d7da; color: #721c24; padding: 15px; text-align: center; border-bottom: 1px solid #f5c6cb;">
        <%= alert %>
      </div>
    <% end %>

    <%= yield %>
    
  </body>
</html>